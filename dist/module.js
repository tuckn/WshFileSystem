!function(){var CD,util,fso,path,os,insp,obtain,isArray,isString,isSolidString,parseDate,startsWith,endsWith,srrd,XCOPY,fs,MODULE_TITLE,throwErrNonExist,throwErrNonStr;Wsh&&Wsh.FileSystem||(Wsh.FileSystem={},CD=Wsh.Constants,util=Wsh.Util,fso=Wsh.FileSystemObject,path=Wsh.Path,os=Wsh.OS,insp=util.inspect,obtain=util.obtainPropVal,isArray=util.isArray,isString=util.isString,isSolidString=util.isSolidString,parseDate=util.createDateString,startsWith=util.startsWith,endsWith=util.endsWith,srrd=os.surroundCmdArg,XCOPY=os.exefiles.xcopy,fs=Wsh.FileSystem,MODULE_TITLE="WshModeJs/FileSystem.js",fs.throwTypeErrorNonExisting=function(moduleTitle,functionName,errVal){throw new Error("Error: ENOENT: no such file or directory\n  at "+functionName+" ("+moduleTitle+")\n  path: "+insp(errVal))},throwErrNonExist=function(functionName,typeErrVal){fs.throwTypeErrorNonExisting(MODULE_TITLE,functionName,typeErrVal)},throwErrNonStr=function(functionName,typeErrVal){util.throwTypeError("string",MODULE_TITLE,functionName,typeErrVal)},fs.constants={F_OK:0,R_OK:4,W_OK:2,X_OK:1,COPYFILE_EXCL:1,O_RDONLY:0,O_WRONLY:1,O_RDWR:2,O_CREAT:256,O_EXCL:1024,O_TRUNC:512,O_APPEND:8,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFLNK:40960,UV_FS_COPYFILE_EXCL:1},fs.inspectPathWhetherMAX_PATH=function(fullPath){var pathLen=fullPath.length;if(255<pathLen)throw new Error("Error: [Too long file path!] Over 255 characters\n  at fs.inspectPathWhetherMAX_PATH ("+MODULE_TITLE+")\n "+pathLen+' length "'+fullPath+'"')},fs.mkdirSync=function(dirPath){isString(dirPath)||throwErrNonStr("fs.mkdirSync",dirPath),fs.inspectPathWhetherMAX_PATH(dirPath),fso.CreateFolder(dirPath)},fs.writeFileSync=function(fpath,data,options){var binNoBom,bomLength,strmNoBom,FN="fs.writeFileSync",encoding=(isString(fpath)||throwErrNonStr(FN,fpath),data===undefined&&(data="undefined"),obtain(options,"encoding","binary")),options=obtain(options,"bom",!1),strm=(/^bin(ary)?$/i.test(encoding)&&isString(data)&&(options=!(encoding="unicode")),WScript.CreateObject("ADODB.Stream")),fpathTmp=os.makeTmpPath();try{if(/^bin(ary)?$/i.test(encoding))return strm.Type=CD.ado.types.binary,strm.Open(),strm.Write(data),strm.SaveToFile(fpathTmp,CD.ado.saveCreates.overWrite),strm.Close(),fs.copyFileSync(fpathTmp,fpath),fs.unlinkSync(fpathTmp),void(strm=null);strm.Type=CD.ado.types.text,/utf(-)?8/i.test(encoding)?strm.Charset=CD.ado.charset.utf8:/utf(-)?16/i.test(encoding)?strm.Charset=CD.ado.charset.utf16:/(cp932|sjis|shift([-_])?jis)/i.test(encoding)?strm.Charset=CD.ado.charset.sjis:strm.Charset=encoding,strm.Open(),strm.WriteText(data),!/(utf-|unicode)/i.test(strm.Charset)||options?(strm.SaveToFile(fpathTmp,CD.ado.saveCreates.overWrite),strm.Close()):(bomLength=strm.Charset===CD.ado.charset.utf8?3:2,strmNoBom=WScript.CreateObject("ADODB.Stream"),strm.Position=0,strm.Type=CD.ado.types.binary,strm.Position=bomLength,binNoBom=strm.Read(CD.ado.reads.all),strm.Close(),strmNoBom.Type=CD.ado.types.binary,strmNoBom.Open(),strmNoBom.Write(binNoBom),strmNoBom.SaveToFile(fpathTmp,CD.ado.saveCreates.overWrite),strmNoBom.Close()),fs.copyFileSync(fpathTmp,fpath),fs.unlinkSync(fpathTmp),strm=null}catch(e){throw new Error(insp(e)+"\n  at "+FN+" ("+MODULE_TITLE+')\n  file: "'+fpath+'"\n  encoding: "'+encoding+'"\n  bom: "'+options+'"\n  data: '+data)}},fs.writeTmpFileSync=function(data,options){var tmpFilePath=os.makeTmpPath("fs-writeTmpFileSync_");return fs.writeFileSync(tmpFilePath,data,options),tmpFilePath},fs.existsSync=function(fpath){return!!isSolidString(fpath)&&(fs.inspectPathWhetherMAX_PATH(fpath),fso.FileExists(fpath)||fso.FolderExists(fpath))},fs.statSync=function(fpath){var fObj,size,isFile,isDir,FN="fs.statSync",FN=(isString(fpath)||throwErrNonStr(FN,fpath),fs.existsSync(fpath)||throwErrNonExist(FN,fpath),fso.FileExists(fpath)?(size=(fObj=fso.GetFile(fpath)).Size,isDir=!(isFile=!0)):fso.FolderExists(fpath)&&(fObj=fso.GetFolder(fpath),size=0,isDir=!(isFile=!1)),fObj.Attributes+0),isSymlink=FN===FILE_ATTRIBUTE_SYMLINKD_DIR||FN===FILE_ATTRIBUTE_SYMLINKD_FILE;return{size:size,isFile:function(){return isFile},isDirectory:function(){return isDir},isSymbolicLink:function(){return isSymlink},atime:new Date(fObj.DateLastAccessed),mtime:new Date(fObj.DateLastModified),ctime:null,birthtime:new Date(fObj.DateCreated)}},fs.readFileSync=function(fpath,options){var FN="fs.readFileSync",encoding=(isString(fpath)||throwErrNonStr(FN,fpath),fs.statSync(fpath).isFile()||throwErrNonExist(FN,fpath),obtain(options,"encoding","binary")),options=obtain(options,"throws",!0),strm=WScript.CreateObject("ADODB.Stream"),data="";try{data=/^bin(ary)?$/i.test(encoding)?(strm.Type=CD.ado.types.binary,strm.Open(),strm.LoadFromFile(fpath),strm.Read(CD.ado.reads.all)):(strm.Type=CD.ado.types.text,/latin(-)?1/i.test(encoding)?strm.Charset=CD.ado.charset.latin1:/utf(-)?8/i.test(encoding)?strm.Charset=CD.ado.charset.utf8:/utf(-)?16/i.test(encoding)?strm.Charset=CD.ado.charset.utf16:/(cp932|sjis|shift([-_])?jis)/i.test(encoding)?strm.Charset=CD.ado.charset.sjis:strm.Charset=encoding,strm.Open(),strm.LoadFromFile(fpath),strm.ReadText(CD.ado.reads.all)),strm.Close()}catch(e){if(options)throw new Error(insp(e)+"\n  at "+FN+" ("+MODULE_TITLE+')\n  file: "'+fpath+'"\n  encoding: "'+encoding+'"\n')}return strm=null,data},fs.getChildrenFiles=function(dirPath,options){var itm,filename,isSymlink,fileInfo,FN="fs.getChildrenFiles",prefixDirName=(isString(dirPath)||throwErrNonStr(FN,dirPath),fs.statSync(dirPath).isDirectory()||throwErrNonExist(FN,dirPath),obtain(options,"prefixDirName","")),matchedRegExp=obtain(options,"matchedRegExp",null),mtchRE=isSolidString(matchedRegExp)?new RegExp(matchedRegExp,"i"):null,matchedRegExp=obtain(options,"ignoredRegExp",null),ignrRE=isSolidString(matchedRegExp)?new RegExp(matchedRegExp,"i"):null,ignoresErr=obtain(options,"ignoresErr",!1),excludesSymlink=obtain(options,"excludesSymlink",!1),withFileTypes=obtain(options,"withFileTypes",!1),matchedRegExp=fso.GetFolder(path.normalize(dirPath)),enmFile=new Enumerator(matchedRegExp.Files),files=[];for(enmFile.moveFirst();!enmFile.atEnd();enmFile.moveNext())if(filename=(itm=enmFile.item()).Name.toString(),filename=path.join(prefixDirName,filename),(!mtchRE||mtchRE.test(filename))&&(!ignrRE||!ignrRE.test(filename)))try{if(withFileTypes){if(isSymlink=fs.statSync(itm.Path).isSymbolicLink(),excludesSymlink&&isSymlink)continue;fileInfo={name:filename,path:itm.Path,attributes:itm.Attributes,isDirectory:!1,isFile:!0,isSymbolicLink:isSymlink,size:itm.Size,dateCreated:parseDate(null,new Date(itm.DateCreated)),dateModified:parseDate(null,new Date(itm.DateLastModified))}}else{if(excludesSymlink&&fs.statSync(itm.Path).isSymbolicLink())continue;fileInfo=filename}files.push(fileInfo)}catch(e){if(ignoresErr)continue;throw new Error(insp(e)+"\n  at "+FN+" ("+MODULE_TITLE+")")}return files},fs.getChildrenDirectories=function(dirPath,options){var itm,dirName,isSymlink,fileInfo,FN="fs.getChildrenDirectories",prefixDirName=(isString(dirPath)||throwErrNonStr(FN,dirPath),fs.statSync(dirPath).isDirectory()||throwErrNonExist(FN,dirPath),obtain(options,"prefixDirName","")),matchedRegExp=obtain(options,"matchedRegExp",null),mtchRE=isSolidString(matchedRegExp)?new RegExp(matchedRegExp,"i"):null,matchedRegExp=obtain(options,"ignoredRegExp",null),ignrRE=isSolidString(matchedRegExp)?new RegExp(matchedRegExp,"i"):null,ignoresErr=obtain(options,"ignoresErr",!1),excludesSymlink=obtain(options,"excludesSymlink",!1),withFileTypes=obtain(options,"withFileTypes",!1),matchedRegExp=fso.GetFolder(path.normalize(dirPath)),enmDir=new Enumerator(matchedRegExp.SubFolders),dirs=[];for(enmDir.moveFirst();!enmDir.atEnd();enmDir.moveNext())if(dirName=(itm=enmDir.item()).Name.toString(),dirName=path.join(prefixDirName,dirName),(!mtchRE||mtchRE.test(dirName))&&(!ignrRE||!ignrRE.test(dirName)))try{if(withFileTypes){if(isSymlink=fs.statSync(itm.Path).isSymbolicLink(),excludesSymlink&&isSymlink)continue;fileInfo={name:dirName,path:itm.Path,attributes:itm.Attributes,isDirectory:!0,isFile:!1,isSymbolicLink:isSymlink,dateCreated:parseDate(null,new Date(itm.DateCreated)),dateModified:parseDate(null,new Date(itm.DateLastModified))}}else{if(excludesSymlink&&fs.statSync(itm.Path).isSymbolicLink())continue;fileInfo=dirName}dirs.push(fileInfo)}catch(e){if(ignoresErr)continue;throw new Error(insp(e)+"\n  at "+FN+" ("+MODULE_TITLE+")")}return dirs},fs.readdirSync=function(dirPath,options){var FN="fs.readdirSync",FN=(isString(dirPath)||throwErrNonStr(FN,dirPath),fs.statSync(dirPath).isDirectory()||throwErrNonExist(FN,dirPath),obtain(options,"isOnlyFile",!1)),files=[],dirs=(obtain(options,"isOnlyDir",!1)||(files=fs.getChildrenFiles(dirPath,options)),[]);return FN||(dirs=fs.getChildrenDirectories(dirPath,options)),files.concat(dirs)},fs.excludeSymboliclinkPaths=function(filePaths,options){var FN="fs.excludeSymboliclinkPaths",ignoresErr=(isArray(filePaths)||util.throwTypeError("array",MODULE_TITLE,FN,filePaths),obtain(options,"ignoresErr",!1)),symlinkDirs=[];return filePaths.filter(function(fp){for(var i=0,len=symlinkDirs.length;i<len;i++)if(startsWith(fp,symlinkDirs[i],0,"i"))return!1;try{var fstat=fs.statSync(fp);if(fstat.isSymbolicLink())return fstat.isDirectory()&&symlinkDirs.push(fp),!1}catch(e){if(ignoresErr)return!1;throw new Error(insp(e)+"\n  at "+FN+" ("+MODULE_TITLE+")")}return!0})},fs.getAllChildrensFullPaths=function(dirPath,options){var FN="fs.getAllChildrensFullPaths",dirPath=(isString(dirPath)||throwErrNonStr(FN,dirPath),fs.statSync(dirPath).isDirectory()||throwErrNonExist(FN,dirPath),[path.normalize(dirPath)]),dirPath=obtain(options,"isOnlyDir",!1)?dirPath.concat(["/A:D","/B","/N","/S","/O:N"]):dirPath.concat(["/B","/N","/S","/O:N"]),retObj=os.execSync("dir",dirPath,{shell:!0});if(retObj.exitCode!==CD.runs.ok)throw new Error("Error: [Error Exit Code]\n  at "+FN+" ("+MODULE_TITLE+")\n  mainCmd: dir\n  args: "+insp(dirPath)+"\n  exitCode: "+retObj.exitCode+"\n  stdout: "+retObj.stdout+"\n  stderr: "+retObj.stderr);FN=retObj.stdout.split("\r\n");return FN.pop(),obtain(options,"excludesSymlink",!1)?FN:fs.excludeSymboliclinkPaths(FN,options)},fs.copyFileSync=function(src,dest,flag){var FN="fs.copyFileSync";if(isString(src)||throwErrNonStr(FN,src),isString(dest)||throwErrNonStr(FN,dest),fs.existsSync(src)||throwErrNonExist(FN,src),flag===fs.constants.COPYFILE_EXCL&&fs.existsSync(dest))throw new Error("Error: [EXIST]: file already exists\n  at "+FN+" ("+MODULE_TITLE+')\n  copyfile "'+src+'" -> "'+dest+'"');try{fso.CopyFile(src,dest,CD.fso.overwrites.yes)}catch(e){throw new Error(insp(e)+"\n  at "+FN+" ("+MODULE_TITLE+')\n  EPERM: operation not permitted, copyfile "'+src+'" -> "'+dest+'")')}},fs.linkSync=function(existingPath,newPath,options){var FN="fs.linkSync";if(isString(newPath)||throwErrNonStr(FN,newPath),isString(existingPath)||throwErrNonStr(FN,existingPath),fs.existsSync(newPath))throw new Error("Error: [EXIST]: file of directory already exists\n  at "+FN+" ("+MODULE_TITLE+')\n  newPath "'+newPath+'"');fs.existsSync(existingPath)||throwErrNonExist(FN,existingPath);var args=[],statSrc=fs.statSync(existingPath);if(statSrc.isFile())args=args.concat([newPath,existingPath]);else{if(!statSrc.isDirectory())throw new Error("Error: [Unknwon file type]:\n  at "+FN+" ("+MODULE_TITLE+')\n  existingPath "'+existingPath+'"');args=args.concat(["/D",newPath,existingPath])}statSrc=obtain(options,"isDryRun",!1),existingPath=os.runAsAdmin("mklink",args,{shell:!0,winStyle:"hidden",isDryRun:statSrc});if(statSrc)return"dry-run ["+FN+"]: "+existingPath;var msecTimeOut=obtain(options,"msecTimeOut",1e4);do{try{if(fs.existsSync(newPath))return!0}catch(e){WScript.Sleep(100),msecTimeOut-=100}}while(0<msecTimeOut);return!1},fs.xcopySync=function(src,dest,options){var retVal,FN="fs.xcopySync",argStr=(isString(src)||throwErrNonStr(FN,src),isString(dest)||throwErrNonStr(FN,dest),fs.existsSync(src)||throwErrNonExist(FN,src),""),src=(fs.statSync(src).isDirectory()?argStr+=" D|"+XCOPY+" "+srrd(src)+" "+srrd(dest)+" /E /I":argStr+=" F|"+XCOPY+" "+srrd(src)+" "+srrd(dest),argStr+=" /H /R /Y",obtain(options,"withStd",!1)),dest=obtain(options,"isDryRun",!1);if(src){if(retVal=os.execSync("ECHO",argStr,{shell:!0,isDryRun:dest}),dest)return"dry-run ["+FN+"]: "+retVal;if(retVal.exitCode===CD.runs.ok)return retVal;throw new Error("Error: [Error Exit Code]\n  at "+FN+" ("+MODULE_TITLE+")\n  mainCmd: ECHO\n  argStr: "+argStr+"\n  exitCode: "+retVal.exitCode+"\n  stdout: "+retVal.stdout+"\n  stderr: "+retVal.stderr)}if(retVal=os.runSync("ECHO",argStr,{shell:!0,winStyle:"hidden",isDryRun:dest}),dest)return"dry-run ["+FN+"]: "+retVal;if(retVal!==CD.runs.ok)throw new Error('Error [ExitCode is not Ok] "'+retVal+'"\n')},fs.rmdirSync=function(dirPath){var FN="fs.rmdirSync";isString(dirPath)||throwErrNonStr(FN,dirPath),fs.statSync(dirPath).isDirectory()||throwErrNonExist(FN,dirPath);try{fso.DeleteFolder(dirPath,CD.fso.force.yes)}catch(e){try{endsWith(dirPath,path.sep)||(dirPath+=path.sep);var retVal=os.runSync("rmdir",["/S","/Q",dirPath],{shell:!0,winStyle:"hidden"});if(retVal===CD.runs.ok)return;throw new Error('Error [ExitCode is not Ok] "'+retVal+'"\n')}catch(e){throw new Error(insp(e)+"\n  at "+FN+" ("+MODULE_TITLE+')\n  EPERM: operation not permitted, "'+dirPath+'"')}}},fs.unlinkSync=function(fpath){var FN="fs.unlinkSync";isString(fpath)||throwErrNonStr(FN,fpath),fs.statSync(fpath).isFile()||throwErrNonExist(FN,fpath);try{fso.DeleteFile(fpath,CD.fso.force.yes)}catch(e){throw new Error(insp(e)+"\n  at "+FN+" ("+MODULE_TITLE+')\n  EPERM: operation not permitted, unlink "'+fpath+'"')}})}();
!function(){Wsh.FileSystemExtra={};var CD=Wsh.Constants,util=Wsh.Util,fso=Wsh.FileSystemObject,path=Wsh.Path,shApp=Wsh.ShellApplication,os=Wsh.OS,fs=Wsh.FileSystem,objAdd=Object.assign,obtain=util.obtainPropVal,isSolidArray=util.isSolidArray,isSolidString=util.isSolidString,isFunction=util.isFunction,isString=util.isString,hasContent=util.hasContent,hasIn=util.hasIn,insp=util.inspect,srrd=os.surroundCmdArg,CERTUTIL=os.exefiles.certutil,fse=Wsh.FileSystemExtra,MODULE_TITLE="WshModeJs/FileSystemExtra.js",throwErrNonStr=function(functionName,typeErrVal){util.throwTypeError("string",MODULE_TITLE,functionName,typeErrVal)},throwErrNonExist=function(functionName,typeErrVal){fs.throwTypeErrorNonExisting(MODULE_TITLE,functionName,typeErrVal)};fse.ensureDirSync=function(dirPath){var FN="fse.ensureDirSync";if(isString(dirPath)||throwErrNonStr(FN,dirPath),!fs.existsSync(dirPath)||!fs.statSync(dirPath).isDirectory())for(var dirFullPath=path.normalize(dirPath),layers=dirFullPath.split(path.sep),layer="",i=path.isUNC(dirFullPath)?(layer="\\\\"+layers[2],3):(layer=layers[0],1),I=layers.length;i<I;i++){layer+=path.sep+layers[i];try{if(fs.existsSync(layer)){if(fs.statSync(layer).isDirectory())continue;fs.mkdirSync(layer)}else fs.mkdirSync(layer)}catch(e){throw new Error(insp(e)+"\n  at "+FN+" ("+MODULE_TITLE+')\n  Failed to create the directory "'+layer+'".\n  dirPath: "'+dirPath+'"')}}},fse.copySync=function(src,dest,options){var FN="fse.copySync",filter=(isString(src)||throwErrNonStr(FN,src),isString(dest)||throwErrNonStr(FN,dest),fs.existsSync(src)||throwErrNonExist(FN,src),obtain(options,"filter",null));if(!isFunction(filter)||filter(src,dest)){filter=obtain(options,"overwrite",!0),options=obtain(options,"errorOnExist",!1);if(!filter&&fs.existsSync(dest)){if(options)throw new Error('Error: [Already Existing] "'+dest+'"/n  at '+FN+" ("+MODULE_TITLE+")")}else try{fse.ensureDirSync(path.dirname(dest));var fsstat=fs.statSync(src);if(fsstat.isFile())fso.CopyFile(src,dest,CD.fso.overwrites.yes);else{if(!fsstat.isDirectory())throw new Error('ENOENT: no such file or directory, "'+src+'"\n  at '+FN+" ("+MODULE_TITLE+")");fso.CopyFolder(src,dest,CD.fso.overwrites.yes)}}catch(e){throw new Error(insp(e)+"\n  at "+FN+" ("+MODULE_TITLE+')\n  src: "'+src+'" -> dest: "'+dest+'"')}}},fse.unzipOfficeOpenXML=function(srcPath,destDir){var FN="fse.unzipOfficeOpenXML",FN=(isSolidString(srcPath)||throwErrNonStr(FN,srcPath),isSolidString(destDir)||throwErrNonStr(FN,destDir),fs.existsSync(srcPath)||throwErrNonExist(FN,srcPath),os.makeTmpPath("fse-unzipOfficeOpenXML_")),srcZipTmp=(fs.mkdirSync(FN),path.join(FN,path.basename(srcPath)+".zip")),srcPath=(fs.copyFileSync(srcPath,srcZipTmp),path.join(FN,path.basename(srcPath))),srcZipTmp=(fs.mkdirSync(srcPath),shApp.NameSpace(srcZipTmp)),srcZipTmp=(shApp.NameSpace(srcPath).CopyHere(srcZipTmp.Items(),16),path.join(destDir,path.basename(srcPath)));return fse.copySync(srcPath,srcZipTmp),fse.removeSync(FN),srcZipTmp},fse.removeSync=function(fpath){var FN="fse.removeSync";if(isString(fpath)||throwErrNonStr(FN,fpath),fs.existsSync(fpath))try{var fsstat=fs.statSync(fpath);if(fsstat.isFile())fs.unlinkSync(fpath);else{if(!fsstat.isDirectory())throw new Error('ENOENT: no such file or directory, "'+fpath+'"\n  at '+FN+" ("+MODULE_TITLE+")");fs.rmdirSync(fpath)}}catch(e){throw new Error(insp(e)+' Failed to delete "'+fpath+'"\n  at '+FN+" ("+MODULE_TITLE+")")}},fse.ensureReadingFile=function(fpath,msecTimeOut,options){var fileData,isInfinity=0===(msecTimeOut=hasContent(msecTimeOut)?msecTimeOut:1e4),isRead=!1;do{try{fileData=fs.readFileSync(fpath,objAdd({},options,{"throws":!0})),isRead=!0}catch(e){if(msecTimeOut-=300,!isInfinity&&msecTimeOut<=0)throw e;WScript.Sleep(300)}}while(!isRead&&(isInfinity||0<msecTimeOut));return fileData},fse.ensureRemovingFile=function(fpath,msecTimeOut){if(!fs.existsSync(fpath))return!0;if(!fs.statSync(fpath).isFile())return!0;hasContent(msecTimeOut)||(msecTimeOut=3e4);do{try{fso.DeleteFile(fpath,CD.fso.force.yes)}catch(e){WScript.Sleep(300),msecTimeOut-=300}}while(fso.FileExists(fpath)&&0<msecTimeOut);return 0<msecTimeOut},fse.writeJsonSync=function(fpJson,obj,options){isString(fpJson)||throwErrNonStr("fse.writeJsonSync",fpJson);var indent=hasIn(options,"indent")?options.indent:4,obj=(null!==indent&&indent!==undefined||(indent=4),JSON.stringify(obj,null,indent)),indent=obtain(options,"lineEnding","\n"),indent=("\n"!==indent&&(obj=obj.replace(/\n/g,indent)),obtain(options,"encoding",CD.ado.charset.utf8)),options=obtain(options,"bom",!1);fs.writeFileSync(fpJson,obj,{encoding:indent,bom:options})},fse.readJsonSync=function(fpJson,options){var FN="fse.readJsonSync",FN=(isString(fpJson)||throwErrNonStr(FN,fpJson),fs.statSync(fpJson).isFile()||throwErrNonExist(FN,fpJson),obtain(options,"encoding",CD.ado.charset.utf8)),options=obtain(options,"throws",!0),fpJson=fs.readFileSync(fpJson,{encoding:FN,"throws":options}),FN={};return FN=fpJson?JSON.parse(fpJson):FN},fse.writeCsvSync=function(csvpath,arrays,options){var FN="fse.writeCsvSync",FN=(isSolidString(csvpath)||throwErrNonStr(FN,csvpath),isSolidArray(arrays)||util.throwTypeError("array",MODULE_TITLE,FN,arrays),util.stringify2DArrayToCsv(arrays,options)),arrays=obtain(options,"encoding",CD.ado.charset.utf8),options=obtain(options,"bom",!0);fs.writeFileSync(csvpath,FN,{encoding:arrays,bom:options})},fse.readCsvSync=function(csvpath,options){fs.existsSync(csvpath)||throwErrNonExist("fse.readCsvSync",csvpath);var encoding=obtain(options,"encoding",CD.ado.charset.utf8),throws=obtain(options,"throws",!0),csvpath=fs.readFileSync(csvpath,{encoding:encoding,"throws":throws});return util.parseCsvTo2DArray(csvpath,options)},fse.readCsvFileAsAssocArray=function(csvpath,options){fs.existsSync(csvpath)||throwErrNonExist("fse.readCsvFileAsAssocArray",csvpath);csvpath=fse.readCsvSync(csvpath,options);return util.conv2DArrayToObj(csvpath,options)},fse.findRequiredFile=function(pathStr,options){var pathStr=path.parse(path.normalize(pathStr)),baseDir=pathStr.dir,pathStr=pathStr.base+obtain(options,"ext",""),options="";if(path.isAbsolute(baseDir))return options=path.join(baseDir,pathStr);if(!isSolidString(baseDir)&&(options=path.join(__dirname,pathStr),fs.existsSync(options)))return options;baseDir=path.join(baseDir,pathStr),options=path.normalize(path.join(__dirname,baseDir));if(fs.existsSync(options))return options;pathStr=path.dirname(__dirname);if(isSolidString(pathStr)){if(options=path.normalize(path.join(pathStr,baseDir)),fs.existsSync(options))return options;pathStr=path.dirname(pathStr)}return pathStr=os.userInfo().homedir,options=path.normalize(path.join(pathStr,baseDir)),fs.existsSync(options)?options:""},fse.copyWshFilesDefinedInWsf=function(srcWsf,destDir){var srcFile,srcWsfLines=fs.readFileSync(srcWsf,{encoding:CD.ado.charset.utf8}).split("\n"),foWsf=path.dirname(srcWsf),srcFiles=[],destFiles=[];srcWsfLines.forEach(function(val){/script language="\w+Script" src="/i.test(val)&&(srcFile=val.match(/src="(.+)"><\/script>/i)[1],srcFiles.push(path.resolve(path.join(foWsf,srcFile))),destFiles.push(path.resolve(path.join(destDir,srcFile))))}),srcFiles.forEach(function(src,i){fs.existsSync(src)&&fs.copyFileSync(src,destFiles[i])})},fse.dirTree=function(dirPath,options){for(var fileExt,FN="fse.dirTree",lines=(isString(dirPath)||throwErrNonStr(FN,dirPath),fs.statSync(dirPath).isDirectory()||throwErrNonExist(FN,dirPath),fs.getAllChildrensFullPaths(dirPath,options)),dirobj=(lines.pop(),lines.sort(function(a,b){return a<b?-1:b<a?1:0}),{children:[]}),dirPt=dirobj,FN=(dirobj.path=dirPath,dirobj.name=path.basename(dirPath),dirobj.type="directory",obtain(options,"exclude","")),regexpExc=isSolidString(FN)?new RegExp(FN):null,FN=obtain(options,"extensions",""),regexpExt=isSolidString(FN)?new RegExp(FN):null,isDefined=!1,i=0,I=lines.length;i<I;i++)if(!regexpExc||!regexpExc.test(lines[i]))for(var names,dirPt=dirobj,joinedPath=dirPath,j=0,J=(names=lines[i].slice(dirPath.length).replace(/^\\+/,"").split(path.sep)).length;j<J;j++){if(joinedPath=path.join(joinedPath,names[j]),!fs.statSync(joinedPath).isDirectory()){fileExt="."+path.extname(joinedPath).toLowerCase(),(regexpExt||regexpExt.test(fileExt))&&dirPt.children.push({path:joinedPath,name:names[j],type:"file",extension:fileExt});break}if(0===dirPt.children.length)dirPt.children.push({path:joinedPath,name:names[j],type:"directory",children:[]}),dirPt=dirPt.children[0];else{for(var isDefined=!1,k=0,K=dirPt.children.length;k<K;k++)if(dirPt.children[k].name===names[j]&&hasIn(dirPt.children[k],"children")){dirPt=dirPt.children[k],isDefined=!0;break}isDefined||(dirPt.children.push({path:joinedPath,name:names[j],type:"directory",children:[]}),dirPt=dirPt.children[dirPt.children.length-1])}}return dirobj},fse.readdirSyncRecursively=function(dirPath,options){var FN="fse.readdirSyncRecursively",rtnFiles=(isString(dirPath)||throwErrNonStr(FN,dirPath),fs.statSync(dirPath).isDirectory()||throwErrNonExist(FN,dirPath),fs.readdirSync(dirPath,options)),FN=fs.readdirSync(dirPath,{prefixDirName:"",isOnlyDir:!0,withFileTypes:!1,ignoresErr:obtain(options,"ignoresErr",!1),excludesSymlink:obtain(options,"excludesSymlink",!1),matchedRegExp:"",ignoredRegExp:""}),prefixDirName=obtain(options,"prefixDirName","");return FN.forEach(function(dirName){dirName=fse.readdirSyncRecursively(path.join(dirPath,dirName),objAdd({},options,{prefixDirName:path.join(prefixDirName,dirName)}));rtnFiles=rtnFiles.concat(dirName)}),rtnFiles},fse.readdirSyncRecursivelyWithDIR=function(dirPath,options){var FN="fse.readdirSyncRecursively",command=(isString(dirPath)||throwErrNonStr(FN,dirPath),fs.statSync(dirPath).isDirectory()||throwErrNonExist(FN,dirPath),"dir "+srrd(dirPath)+" /B /N /S /O:N"),exeCmd=srrd(os.exefiles.cmd)+' /S /C"'+command+'"',exeCmd=os.execSync(exeCmd);if(exeCmd.exitCode!==CD.runs.ok)throw new Error("Error: [ExitCode is not 0]\n  at "+FN+" ("+MODULE_TITLE+")\n  command: "+command+"\n  exitCode: "+exeCmd.exitCode+"\n  stdout: "+exeCmd.stdout+"\n  stderr: "+exeCmd.stderr);var rtnName,isDir,FN=exeCmd.stdout.split("\r\n"),withFileTypes=(FN.pop(),obtain(options,"withFileTypes",!1)),command=obtain(options,"matchedRegExp",null),exeCmd=obtain(options,"ignoredRegExp",null),mtchRE=isSolidString(command)?new RegExp(command,"i"):null,ignrRE=isSolidString(exeCmd)?new RegExp(exeCmd,"i"):null,rtnNames=[];return FN.forEach(function(fullPath){rtnName=fullPath.replace(dirPath,"").replace(/^\\/,""),null!==mtchRE&&!mtchRE.test(rtnName)||null!==ignrRE&&ignrRE.test(rtnName)||(withFileTypes?fs.existsSync(fullPath)&&(isDir=fs.statSync(fullPath).isDirectory(),rtnNames.push({name:rtnName,path:fullPath,isDirectory:isDir,isFile:!isDir})):rtnNames.push(rtnName))}),rtnNames},fse.getTruePath=function(fp){path.isAbsolute(fp)},fse.calcCryptHash=function(filepath,algorithm,options){var FN="fse.calcCryptHash",fStat=(isString(filepath)||throwErrNonStr(FN,filepath),obtain(options,"fsStatObj",fs.statSync(filepath)));if(fStat.isFile()||throwErrNonExist(FN,filepath),0===fStat.size)return 0;fStat=isSolidString(algorithm)?algorithm.toUpperCase():"SHA256",algorithm=["-hashfile",filepath,fStat];try{var isDryRun=obtain(options,"isDryRun",!1),retVal=os.execSync(CERTUTIL,algorithm,{shell:!1,isDryRun:isDryRun});if(isDryRun)return"dry-run ["+FN+"]: "+retVal;if(retVal.exitCode!==CD.runs.ok)throw new Error("Error: [ExitCode is "+retVal.exitCode+"]\n")}catch(e){options=os.makeTmpPath("fse-calcCryptHash_");if(fse.copySync(filepath,options),retVal=os.execSync(CERTUTIL,algorithm=["-hashfile",options,fStat],{shell:!1}),fse.removeSync(options),retVal.exitCode!==CD.runs.ok)throw new Error(insp(e)+"\n  at "+FN+" ("+MODULE_TITLE+")\n  exitCode: "+retVal.exitCode+"\n  stdout: "+retVal.stdout+"\n  stderr: "+retVal.stderr)}return retVal.stdout.replace(/\r/g,"").split("\n")[1]},fse.compareFilesOfModifiedDate=function(fpA,fpB,options){var FN="fse.compareFilesOfModifiedDate",fAStat=obtain(options,"fsAStatObj",fs.statSync(fpA)),fpA=(fs.statSync(fpA).isFile()||throwErrNonExist(FN,fpA),obtain(options,"fsBStatObj",fs.statSync(fpB)));return fs.statSync(fpB).isFile()||throwErrNonExist(FN,fpB),Math.abs(Number(fAStat.mtime)-Number(fpA.mtime))<3e3},fse.isTheSameFile=function(fpA,fpB,algorithm){var FN="fse.isTheSameFile",fAStat=fs.statSync(fpA),fBStat=(fAStat.isFile()||throwErrNonExist(FN,fpA),fs.statSync(fpB));return fBStat.isFile()||throwErrNonExist(FN,fpB),isSolidString(algorithm)&&"DATE"!==algorithm.toUpperCase()?fse.calcCryptHash(fpA,algorithm,{fsStatObj:fAStat})===fse.calcCryptHash(fpB,algorithm,{fsStatObj:fBStat}):fse.compareFilesOfModifiedDate(fpA,fpB,{fsAStatObj:fAStat,fsBStatObj:fBStat})}}();
